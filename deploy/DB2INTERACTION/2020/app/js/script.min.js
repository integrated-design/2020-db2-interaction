var project,__extends=this&&this.__extends||function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();(project||(project={})).FileInfo=function(e){this.fileName=e.fileName,this.startTime=e.startTime||0},function(e){var n,t=alm.view.View,o=(__extends(i,n=t),i.prototype.implInitialize=function(){var e=this.getView();this.typeField=e.find("#type"),this.typeField.text(this.type),this.playButton=e.find("#play-button"),this.playButton.addClass("disabled"),this.playButton.text("LOADING"),this.fileLogContainer=e.find("#log"),this.fileLogFields=[];var t=this.fileInfos.length;if(0<t)for(var o=0;o<t;++o){var i=jQuery("<div>");i.addClass("file"),this.fileLogContainer.append(i),this.fileLogFields.push(i),this.updateFileLoadProgress(o,0)}else this.fileLogContainer.text("error : no file");return e},i.prototype.implReady=function(){},i.prototype.implFinalize=function(){},i.prototype.implShow=function(e,t){return new cmd.Func(function(){e.css("display","block")})},i.prototype.implHide=function(e,t){return new cmd.Func(function(){e.css("display","none")})},i.prototype.updateFileLoadProgress=function(e,t){var o=this.fileInfos[e],i="";switch(t){case-1:i="load error";break;case 1:i="load complete";break;case 0:i="loading";break;default:i=Math.floor(100*t)+"%"}this.fileLogFields[e].text(o.fileName+" : "+i)},i.prototype.enablePlayButton=function(){this.playButton.text("START"),this.playButton.removeClass("disabled"),this.playButton.on("click",this.playButtonClickHandler)},i);function i(e,t,o){var i=n.call(this,e)||this;return i.playButtonClickHandler=function(e){i.dispatchEventType("playButtonClick",i)},i.type=t,i.fileInfos=o,i.initialize(),i}e.Loading=o}(project=project||{}),function(i){var n,e=alm.view.View,t=(__extends(o,n=e),o.prototype.implInitialize=function(){var e=jQuery("<div>");return e.addClass("video"),this.player=document.createElement("video"),this.player.autoplay=!1,this.player.loop=!1,this.player.muted=!1,this.player.controls=!1,this.player.setAttribute("playsinline",""),e.append(jQuery(this.player)),this.isLoading=!1,this.isLoaded=!1,this.isPlaying=!1,e},o.prototype.implReady=function(){},o.prototype.implFinalize=function(){},o.prototype.implShow=function(e,t){var o=this;return new cmd.Func(function(){trace("[Video] show : video index =",o.videoIndex),e.css("display","block")})},o.prototype.implHide=function(e,t){var o=this;return new cmd.Func(function(){trace("[Video] hide : video index =",o.videoIndex),e.css("display","none")})},o.prototype.load=function(){this.isLoading||this.isLoaded||(this.isLoading=!0,trace("[Video] load start : url =",this.fileInfo.fileName),this.player.addEventListener("progress",this.loadProgressHandler),this.player.addEventListener("canplaythrough",this.loadCompleteHandler),this.player.addEventListener("error",this.loadErrorHandler),this.player.addEventListener("ended",this.playerEndedHandler),this.player.src=this.fileInfo.fileName+"?"+Date.now(),this.player.load())},o.prototype.play=function(){this.isLoaded&&!this.isPlaying&&(this.isPlaying=!0,this.player.play())},o.prototype.pause=function(){this.isLoaded&&this.isPlaying&&(this.isPlaying=!1,this.player.pause())},o.prototype.rewind=function(){this.isLoaded&&(this.player.currentTime=0)},o.prototype.seekVideo=function(e,t){this.isLoaded&&(this.player.currentTime=t)},o.prototype.loadEndAndDispatchEvent=function(e){trace("[Video] load complete : video index =",this.videoIndex),this.isLoading=!1,this.isLoaded=!0,this.player.removeEventListener("progress",this.loadProgressHandler),this.player.removeEventListener("canplaythrough",this.loadCompleteHandler),this.player.removeEventListener("error",this.loadErrorHandler),this.player.currentTime=0,this.dispatchEvent(new i.VideoLoadEvent(e,this,this.videoIndex,this.fileInfo))},o);function o(e,t){var o=n.call(this)||this;return o.loadProgressHandler=function(e){var t=0;0<o.player.buffered.length&&(t=(o.player.buffered.end(0)-o.player.buffered.start(0))/o.player.duration),o.dispatchEvent(new i.VideoLoadProgressEvent(i.VideoLoadProgressEvent.progress,o,o.videoIndex,o.fileInfo,t))},o.loadCompleteHandler=function(){o.loadEndAndDispatchEvent(i.VideoLoadEvent.complete)},o.loadErrorHandler=function(){o.loadEndAndDispatchEvent(i.VideoLoadEvent.error)},o.playerEndedHandler=function(){o.player.play(),o.dispatchEvent(new i.VideoEvent(i.VideoEvent.loop,o,o.videoIndex,o.fileInfo))},o.videoIndex=e,o.fileInfo=t,o.initialize(),o}i.Video=t}(project=project||{}),function(e){var r,t=(r=alm.event.Event,__extends(o,r),o.loop="VideoEvent.loop",o);function o(e,t,o,i){var n=r.call(this,e,t)||this;return n.videoIndex=o,n.fileInfo=i,n}e.VideoEvent=t}(project=project||{}),function(e){var r,t=(r=alm.event.Event,__extends(o,r),o.complete="VideoLoadEvent.complete",o.error="VideoLoadEvent.error",o);function o(e,t,o,i){var n=r.call(this,e,t)||this;return n.videoIndex=o,n.fileInfo=i,n}e.VideoLoadEvent=t}(project=project||{}),function(e){var d,t=(d=alm.event.Event,__extends(o,d),o.progress="VideoLoadProgressEvent.progress",o);function o(e,t,o,i,n){var r=d.call(this,e,t)||this;return r.videoIndex=o,r.fileInfo=i,r.progressRatio=n,r}e.VideoLoadProgressEvent=t}(project=project||{}),function(i){var o,e=alm.view.View,t=(__extends(n,o=e),n.prototype.implInitialize=function(){var e=this.getView();this.videos=[],this.videoCount=this.fileInfos.length;for(var t=0;t<this.videoCount;++t){var o=new i.Video(t,this.fileInfos[t]);o.ready(),e.append(o.getView()),this.videos.push(o)}return e},n.prototype.implReady=function(){},n.prototype.implFinalize=function(){},n.prototype.implShow=function(e,t){return new cmd.Func(function(){e.css("display","block")})},n.prototype.implHide=function(e,t){return new cmd.Func(function(){e.css("display","none")})},n.prototype.load=function(){for(var e=this.loadedVideoCount=0;e<this.videoCount;++e){var t=this.videos[e];t.addEventListener(i.VideoLoadProgressEvent.progress,this.videoLoadProgressHandler),t.addEventListener(i.VideoLoadEvent.complete,this.videoLoadCompleteHandler),t.addEventListener(i.VideoLoadEvent.error,this.videoLoadErrorHandler),t.addEventListener(i.VideoEvent.loop,this.videoLoopHandler),t.load()}},n.prototype.showVideo=function(e){this.videos[e].show()},n.prototype.hideVideo=function(e){this.videos[e].hide()},n.prototype.playVideo=function(e){this.videos[e].play()},n.prototype.pauseVideo=function(e){this.videos[e].pause()},n.prototype.rewindVideo=function(e){this.videos[e].rewind()},n.prototype.seekVideo=function(e,t){this.videos[e].seekVideo(e,t)},n);function n(e){var t=o.call(this,jQuery("#video-container"))||this;return t.videoLoadProgressHandler=function(e){t.dispatchEvent(e)},t.videoLoadCompleteHandler=function(e){t.dispatchEvent(e),++t.loadedVideoCount==t.videoCount&&t.dispatchEvent(new i.VideoContainerLoadEvent(i.VideoContainerLoadEvent.complete,t))},t.videoLoadErrorHandler=function(e){t.dispatchEvent(e)},t.videoLoopHandler=function(e){t.dispatchEvent(e)},t.fileInfos=e,t.initialize(),t}i.VideoContainer=t}(project=project||{}),function(e){var o,t=(o=alm.event.Event,__extends(i,o),i.complete="VideoContainerLoadEvent.complete",i.error="VideoContainerLoadEvent.error",i);function i(e,t){return o.call(this,e,t)||this}e.VideoContainerLoadEvent=t}(project=project||{}),function(d){var a=alm.browser.DeviceInfo,e=(t.prototype.run=function(){this.loading=new d.Loading(jQuery("#loading"),this.type,this.fileInfos),this.loading.addEventListener("playButtonClick",this.playButtonClickHandler),this.loading.ready(),this.loading.show(),this.videoContainer=new d.VideoContainer(this.fileInfos),this.videoContainer.ready(),this.videoContainer.addEventListener(d.VideoLoadProgressEvent.progress,this.videoLoadProgressHandler),this.videoContainer.addEventListener(d.VideoLoadEvent.complete,this.videoLoadCompleteHandler),this.videoContainer.addEventListener(d.VideoLoadEvent.error,this.videoLoadErrorHandler),this.videoContainer.addEventListener(d.VideoContainerLoadEvent.complete,this.videoContainerLoadCompleteHandler),this.videoContainer.addEventListener(d.VideoEvent.loop,this.videoLoopHandler),this.videoContainer.load()},t.prototype.showVideo=function(e){this.videoContainer.showVideo(e)},t.prototype.hideVideo=function(e){this.videoContainer.hideVideo(e)},t.prototype.playVideo=function(e){this.videoContainer.playVideo(e)},t.prototype.pauseVideo=function(e){this.videoContainer.pauseVideo(e)},t.prototype.rewindVideo=function(e){this.videoContainer.rewindVideo(e)},t.prototype.seekVideo=function(e,t){this.videoContainer.seekVideo(e,t)},t.prototype.implPlay=function(){},t.prototype.implTouchStart=function(){},t.prototype.implTouchEnd=function(){},t.prototype.implLoop=function(e){},t.prototype.getFileInfo=function(e){return this.fileInfos[e]},t);function t(e,t){var o=this;this.videoLoadCompleteHandler=function(e){o.loading.updateFileLoadProgress(e.videoIndex,1)},this.videoLoadErrorHandler=function(e){o.loading.updateFileLoadProgress(e.videoIndex,-1)},this.videoLoadProgressHandler=function(e){o.loading.updateFileLoadProgress(e.videoIndex,e.progressRatio)},this.videoContainerLoadCompleteHandler=function(e){o.loading.enablePlayButton()},this.videoLoopHandler=function(e){var t=e.videoIndex;o.implLoop(t)},this.playButtonClickHandler=function(e){o.loading.hide(),trace("[Application] fullscreen capability :",screenfull.isEnabled),screenfull.isEnabled&&screenfull.request(),a.getIsTouchEnabled()?(trace("[Application] setup with touch interaction"),window.addEventListener("touchstart",o.touchStartHandler),window.addEventListener("touchend",o.touchEndHandler)):(trace("[Application] setup with mouse interaction"),window.addEventListener("mousedown",o.mouseDownHandler),window.addEventListener("mouseup",o.mouseUpHandler)),window.addEventListener("contextmenu",o.contextMenuHandler),o.videoContainer.show(),o.implPlay()},this.touchStartHandler=function(e){e.preventDefault(),e.stopPropagation(),o.implTouchStart()},this.touchEndHandler=function(e){e.preventDefault(),e.stopPropagation(),o.implTouchEnd()},this.mouseDownHandler=function(e){e.preventDefault(),e.stopPropagation(),o.implTouchStart()},this.mouseUpHandler=function(e){e.preventDefault(),e.stopPropagation(),o.implTouchEnd()},this.contextMenuHandler=function(e){e.preventDefault(),e.stopPropagation()},this.type=e,this.fileInfos=[];var i=window.assetInfos;if(i)for(var n=i.length,r=0;r<n;++r)this.fileInfos.push(new d.FileInfo(i[r]));else for(n=t.length,r=0;r<n;++r)this.fileInfos.push(new d.FileInfo({fileName:t[r]}))}d.Application=e}(project=project||{}),function(e){var t,o=(t=e.Application,__extends(i,t),i.prototype.implPlay=function(){this.seekVideo(0,this.getFileInfo(0).startTime),this.showVideo(0),this.playVideo(0)},i.prototype.implTouchStart=function(){var e=this;window.clearTimeout(this.timeoutIdA),this.timeoutIdA=window.setTimeout(function(){e.pauseVideo(0),e.rewindVideo(0)},50),window.clearTimeout(this.timeoutIdB),this.showVideo(1),this.playVideo(1)},i.prototype.implTouchEnd=function(){var e=this;window.clearTimeout(this.timeoutIdA),this.playVideo(0),this.hideVideo(1),window.clearTimeout(this.timeoutIdB),this.timeoutIdB=window.setTimeout(function(){e.pauseVideo(1),e.rewindVideo(1)},50)},i);function i(){var e=t.call(this,"Touch B & Release A (Rewind)",["a.mp4","b.mp4"])||this;return e.timeoutIdA=-1,e.timeoutIdB=-1,e}e.TouchBReleaseARewind=o}(project=project||{}),function(e){var t,o=(t=e.Application,__extends(i,t),i.prototype.implPlay=function(){this.activeVideoIndex=0,this.showVideo(0),this.playVideo(0),this.playVideo(1)},i.prototype.implTouchStart=function(){this.activeVideoIndex=1,this.hideVideo(0),this.showVideo(1)},i.prototype.implTouchEnd=function(){this.activeVideoIndex=0,this.hideVideo(1),this.showVideo(0)},i.prototype.implLoop=function(e){e==this.activeVideoIndex&&this.rewindVideo(1-e)},i);function i(){return t.call(this,"Touch B & Release A - Sync",["a.mp4","b.mp4"])||this}e.TouchBReleaseASync=o}(project=project||{}),function(e){var t,o=(t=e.Application,__extends(i,t),i.prototype.implPlay=function(){this.showVideo(0)},i.prototype.implTouchStart=function(){this.playVideo(0)},i.prototype.implTouchEnd=function(){this.pauseVideo(0)},i);function i(){return t.call(this,"Touch Play & Release Stop",["a.mp4"])||this}e.TouchPlayReleaseStop=o}(project=project||{}),function(t){jQuery(document).ready(function(){var e=null;switch(window.type){case 0:e=new t.TouchPlayReleaseStop;break;case 1:e=new t.TouchBReleaseARewind;break;case 2:e=new t.TouchBReleaseASync}e&&e.run()})}(project=project||{});
//# sourceMappingURL=script.min.js.map
